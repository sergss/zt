# Level Validator Tool

Утилита для автоматической проверки и исправления ошибок спавна сущностей (игрока, врагов, предметов) внутри геометрии стен на уровнях игры.

## Зачем это нужно?
В процессе разработки уровней в `d:\code\zt\js\levels.js` можно легко ошибиться и поставить координаты врага или аптечки:
1. За пределами карты.
2. Прямо внутрь стены (`value 1, 2, 3, 4`) или непроходимых дверей.

Эта утилита проверяет все созданные уровни и **автоматически сдвигает застрявшие сущности на ближайшую свободную клетку пола**.

## Как использовать

1. Откройте терминал (PowerShell или CMD) в корне проекта \`d:\code\zt\`.
2. Запустите скрипт через Node.js:
   \`\`\`bash
   node tools/level_validator.js
   \`\`\`

## Что делает скрипт?

1. Парсит текущий файл `js/levels.js`.
2. Вычисляет физические координаты всех сущностей на карте.
3. Если сущность попадает в твердую стену, она ищет кратчайший путь (BFS алгоритм) до ближайшего "пола" (значение `0`).
4. Автоматически перезаписывает файл `js/levels.js`, внося новые безопасные координаты.
5. Генерирует подробный текстовый отчет `tools/validation_report.txt`, где перечислено:
   - Какие сущности застряли.
   - Куда они были передвинуты.
   - Есть ли изолированные (недоступные) комнаты на уровне, которые нужно исправить вручную в матрице `mapData`.

## Примечания

* Скрипт **НЕ изменяет** матрицу геометрии стен \`mapData\`. Если в результате дизайна карты у вас образовалась изолированная от игрока закрытая комната (недоступный пол), скрипт просто напишет предупреждение в логе, вам нужно будет пробить проход вручную.
* Авто-фикс использует умное регулярное выражение для перезаписи, поэтому он сохраняет вашу оригинальную структуру кода в `levels.js`.
* Всегда запускайте эту утилиту перед релизом игры, чтобы নিশ্চিতствовать проходимость!
